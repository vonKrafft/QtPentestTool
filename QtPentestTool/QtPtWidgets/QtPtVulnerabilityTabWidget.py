# Copyright (c) 2019 vonKrafft <contact@vonkrafft.fr>
# 
# This file is part of QtPentestTool.
# 
# This file may be used under the terms of the GNU General Public License
# version 3.0 as published by the Free Software Foundation and appearing in
# the file LICENSE included in the packaging of this file. Please review the
# following information to ensure the GNU General Public License version 3.0
# requirements will be met: http://www.gnu.org/copyleft/gpl.html.
# 
# This file is provided AS IS with NO WARRANTY OF ANY KIND, INCLUDING THE
# WARRANTY OF DESIGN, MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.

from PyQt5 import QtCore
from PyQt5 import QtGui
from PyQt5 import QtWidgets


class QVulnerabilityTabWidget(QtWidgets.QWidget):
    """Vulnerability tab widget for QtPentestTool.

    Attributes:
        layout (QtWidgets.QVBoxLayout): Current widget's layout

        tabs (QtWidgets.QTabWidget)

        descriptionTab (QtWidgets.QWidget)
        impactTab (QtWidgets.QWidget)
        remediationTab (QtWidgets.QWidget)

        descriptionInput (QtWidgets.QTextEdit)
        impactInput (QtWidgets.QTextEdit)
        remediationInput (QtWidgets.QTextEdit)

    Signals:
        textChanged (QtCore.pyqtSignal)

    """

    """ SIGNAL emitted when one of the text changes """
    textChanged = QtCore.pyqtSignal()

    def __init__(self, *args, **kwargs) -> None:
        """ Class constructor.

        Args:
            *args: Variable length argument list
            **kwargs: Arbitrary keyword arguments

        """
        super(QVulnerabilityTabWidget, self).__init__(*args, **kwargs)

        self.layout = QtWidgets.QVBoxLayout()
        self.layout.setContentsMargins(0, 0, 0, 0)
        self.setLayout(self.layout)

        # Tabs

        self.descriptionTab = QtWidgets.QWidget()
        self.impactTab = QtWidgets.QWidget()
        self.remediationTab = QtWidgets.QWidget()

        self.tabs = QtWidgets.QTabWidget()
        self.tabs.addTab(self.descriptionTab, 'Description')
        self.tabs.addTab(self.impactTab, 'Impact')
        self.tabs.addTab(self.remediationTab, 'Remediation')

        # Description

        self.descriptionTabLayout = QtWidgets.QVBoxLayout()
        self.descriptionInput = QtWidgets.QTextEdit(self)
        self.descriptionInput.setSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Expanding)
        self.descriptionInput.setAcceptRichText(False)
        self.descriptionInput.setCurrentFont(QtGui.QFont('Courier', 9))
        self.descriptionInput.textChanged.connect(self.__triggerTextChanged)
        self.descriptionTabLayout.addWidget(self.descriptionInput)
        self.descriptionTab.setLayout(self.descriptionTabLayout)

        # Impact

        self.impactTabLayout = QtWidgets.QVBoxLayout()
        self.impactInput = QtWidgets.QTextEdit(self)
        self.impactInput.setSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Expanding)
        self.impactInput.setAcceptRichText(False)
        self.impactInput.setCurrentFont(QtGui.QFont('Courier', 9))
        self.impactInput.textChanged.connect(self.__triggerTextChanged)
        self.impactTabLayout.addWidget(self.impactInput)
        self.impactTab.setLayout(self.impactTabLayout)

        # Remediation

        self.remediationTabLayout = QtWidgets.QVBoxLayout()
        self.remediationInput = QtWidgets.QTextEdit(self)
        self.remediationInput.setSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Expanding)
        self.remediationInput.setAcceptRichText(False)
        self.remediationInput.setCurrentFont(QtGui.QFont('Courier', 9))
        self.remediationInput.textChanged.connect(self.__triggerTextChanged)
        self.remediationTabLayout.addWidget(self.remediationInput)
        self.remediationTab.setLayout(self.remediationTabLayout)

        # QVulnerabilityTabWidget

        self.layout.addWidget(self.tabs)

    def setDescription(self, text: str) -> None:
        """ Setter for the 'description' input text.

        Args:
            text (str): The value to set in the 'description' input

        """
        self.descriptionInput.setCurrentFont(QtGui.QFont('Courier', 9))
        self.descriptionInput.setPlainText(text)

    def description(self) -> str:
        """ Getter for the 'description' input text.

        Returns:
            str: The current value of the 'description' input

        """
        return self.descriptionInput.toPlainText()

    def setImpact(self, text: str) -> None:
        """ Setter for the 'impact' input text.

        Args:
            text (str): The value to set in the 'impact' input

        """
        self.impactInput.setCurrentFont(QtGui.QFont('Courier', 9))
        self.impactInput.setPlainText(text)

    def impact(self) -> str:
        """ Getter for the 'impact' input text.

        Returns:
            str: The current value of the 'impact' input

        """
        return self.impactInput.toPlainText()

    def setRemediation(self, text: str) -> None:
        """ Setter for the 'remediation' input text.

        Args:
            text (str): The value to set in the 'remediation' input

        """
        self.remediationInput.setCurrentFont(QtGui.QFont('Courier', 9))
        self.remediationInput.setPlainText(text)

    def remediation(self) -> str:
        """ Getter for the 'remediation' input text.

        Returns:
            str: The current value of the 'remediation' input

        """
        return self.remediationInput.toPlainText()

    def __triggerTextChanged(self) -> None:
        """ Emit 'textChanged' SIGNAL.

        """
        self.textChanged.emit()